<!DOCTYPE html>
<html>
  <head>
    <title>Interactive Map of UFO Sightings</title>
    <link rel="icon" href="data:;base64,iVBORwOKGO=" />
    <link rel="stylesheet" href="css/leaflet.css" />
    <link rel="stylesheet" href="css/style.css" />
  </head>
  <body>
    <h1>Interactive Map of UFO Sightings</h1>
    <h3 id="sightings-not-mapped"></h3>
    <!-- <div id="color-by-options"></div> -->
    <div id="map-background-options"></div>
    <div id="color-by">Color By</div>
    <div id="my-map"></div>
    <div style="display: flex; flex-direction: column">
      <div class="container">
        <input
          id="searchbar"
          onkeyup="search_data()"
          type="text"
          name="search"
          placeholder="Search data..."
        />
        <div id="search-frequency"></div>
      </div>
      <div>
        <select id="first-dropdown">
          <option value="date_time">Year</option>
          <option value="city_area">City Area</option>
          <option value="state">State</option>
          <option value="country">Country</option>
          <option value="ufo_shape">UFO Shape</option>
        </select>
        <select id="second-dropdown"></select>
      </div>
      <!-- <div id="mapId" style="width: 600px; height: 400px;"></div> -->
      <svg id="barchart"></svg>
      <svg id="tod"></svg>
      <div>
        <select id="annual-cycle-dropdown">
          <option value="month">By Month</option>
          <option value="day">By Day of the Week</option>
          <option value="season">By Season</option>
        </select>
      </div>
      <svg id="annual-cycle-histogram" height="250"></svg>
      <svg id="timeline"></svg><br />
      <h4>Frequency of Encounter Length</h4>
      <div id="bc"></div>
    </div>

    <script src="js/d3.v6.min.js"></script>
    <script type="module" src="js/main.js"></script>
    <script src="js/leaflet.js"></script>
    <script src="js/leafletMap.js"></script>
    <script src="js/barchart.js"></script>
    <script src="js/tod.js"></script>
    <script src="js/timeline.js"></script>
    <script src="js/cycleHistogram.js"></script>
    <script src="js/histogram.js"></script>
    <script src="js/bc.js"></script>
    <script>
      function search_data() {
        let input = document.getElementById("searchbar").value.toLowerCase();
        let sum_count = 0;

        d3.csv("data/ufo_sightings.csv").then((data) => {
          data.forEach((d) => {
            if (input != "") {
              if (d.description.toLowerCase().match(input)) {
                sum_count += d.description.toLowerCase().match(input).length;
              }
            }
          });
          if (document.getElementById("searchbar").value != "") {
            document.getElementById("search-frequency").innerHTML =
              "The phrase: '" +
              document.getElementById("searchbar").value +
              "' appears in " +
              sum_count +
              " report";
            if (sum_count > 1) {
              document.getElementById("search-frequency").innerHTML =
                document.getElementById("search-frequency").innerHTML + "s";
            }
          } else {
            document.getElementById("search-frequency").innerHTML = "";
          }
        });
      }
    </script>
    <div id="tooltip"></div>
  </body>
</html>
